"use strict";(self["webpackChunkvue_backstage"]=self["webpackChunkvue_backstage"]||[]).push([[174],{2549:function(e,l,a){a.d(l,{Yu:function(){return i},PR:function(){return m}});var t=a(1076),o={baseUrl:{dev:"/api/",pro:""}};const r=o.baseUrl.pro;class n{constructor(){this.instance=t.Z.create({baseURL:r,headers:{}}),console.log("Axios instance:",this.instance),this.interceptors()}interceptors(){this.instance.interceptors.request.use((function(e){return console.log("Request intercept:",e),e}),(function(e){return console.error("Request Error intercept:",e),Promise.reject(e)})),this.instance.interceptors.response.use((function(e){return console.log("Response Interceptor:","response"),e}),(function(e){return console.log("Response Error Interceptor:","error"),Promise.reject(e)}))}request(e){return this.instance(e)}}var d=new n;const i=()=>d.request({url:"/home/getData",method:"get"}),m=e=>d.request({url:"user/getUser",method:"get",params:e})},1174:function(e,l,a){a.r(l),a.d(l,{default:function(){return F}});var t=a(3396);const o={class:"manage"},r={key:2},n={class:"manage-header"};function d(e,l,a,d,i,m){const s=(0,t.up)("el-input"),u=(0,t.up)("el-form-item"),p=(0,t.up)("el-date-picker"),c=(0,t.up)("el-form"),h=(0,t.up)("el-button"),f=(0,t.up)("el-dialog"),g=(0,t.up)("common-form"),b=(0,t.up)("common-table");return(0,t.wg)(),(0,t.iD)("div",o,[(0,t.Wm)(f,{title:"提示",modelValue:i.dialogVisible,"onUpdate:modelValue":l[12]||(l[12]=e=>i.dialogVisible=e),width:"40%"},{footer:(0,t.w5)((()=>[(0,t.Wm)(h,{onClick:l[10]||(l[10]=e=>i.dialogVisible=!1)},{default:(0,t.w5)((()=>[(0,t.Uk)("取 消")])),_:1}),(0,t.Wm)(h,{type:"primary",onClick:l[11]||(l[11]=e=>(i.dialogVisible=!1,m.confirm()))},{default:(0,t.w5)((()=>[(0,t.Uk)("确 定")])),_:1})])),default:(0,t.w5)((()=>["add"===i.operateType?((0,t.wg)(),(0,t.j4)(c,{key:0,model:i.form,rules:i.rules,ref:"addForm",inline:!0},{default:(0,t.w5)((()=>[(0,t.Wm)(u,{label:"姓名",prop:"name"},{default:(0,t.w5)((()=>[(0,t.Wm)(s,{modelValue:i.form.name,"onUpdate:modelValue":l[0]||(l[0]=e=>i.form.name=e)},null,8,["modelValue"])])),_:1}),(0,t.Wm)(u,{label:"性別",prop:"sex"},{default:(0,t.w5)((()=>[(0,t.Wm)(s,{modelValue:i.form.sex,"onUpdate:modelValue":l[1]||(l[1]=e=>i.form.sex=e)},null,8,["modelValue"])])),_:1}),(0,t.Wm)(u,{label:"年龄",prop:"age"},{default:(0,t.w5)((()=>[(0,t.Wm)(s,{modelValue:i.form.age,"onUpdate:modelValue":l[2]||(l[2]=e=>i.form.age=e)},null,8,["modelValue"])])),_:1}),(0,t.Wm)(u,{label:"出生日期",prop:"birth"},{default:(0,t.w5)((()=>[(0,t.Wm)(p,{modelValue:i.form.birth,"onUpdate:modelValue":l[3]||(l[3]=e=>i.form.birth=e)},null,8,["modelValue"])])),_:1}),(0,t.Wm)(u,{label:"地址",prop:"addr"},{default:(0,t.w5)((()=>[(0,t.Wm)(s,{modelValue:i.form.addr,"onUpdate:modelValue":l[4]||(l[4]=e=>i.form.addr=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])):"edit"===i.operateType?((0,t.wg)(),(0,t.j4)(c,{key:1,model:i.operateForm,ref:"editForm",inline:!0},{default:(0,t.w5)((()=>[(0,t.Wm)(u,{label:"姓名",prop:"name"},{default:(0,t.w5)((()=>[(0,t.Wm)(s,{modelValue:i.operateForm.name,"onUpdate:modelValue":l[5]||(l[5]=e=>i.operateForm.name=e)},null,8,["modelValue"])])),_:1}),(0,t.Wm)(u,{label:"性別",prop:"sex"},{default:(0,t.w5)((()=>[(0,t.Wm)(s,{modelValue:i.operateForm.sex,"onUpdate:modelValue":l[6]||(l[6]=e=>i.operateForm.sex=e)},null,8,["modelValue"])])),_:1}),(0,t.Wm)(u,{label:"年龄",prop:"age"},{default:(0,t.w5)((()=>[(0,t.Wm)(s,{modelValue:i.operateForm.age,"onUpdate:modelValue":l[7]||(l[7]=e=>i.operateForm.age=e)},null,8,["modelValue"])])),_:1}),(0,t.Wm)(u,{label:"出生日期",prop:"birth"},{default:(0,t.w5)((()=>[(0,t.Wm)(p,{modelValue:i.operateForm.birth,"onUpdate:modelValue":l[8]||(l[8]=e=>i.operateForm.birth=e)},null,8,["modelValue"])])),_:1}),(0,t.Wm)(u,{label:"地址",prop:"addr"},{default:(0,t.w5)((()=>[(0,t.Wm)(s,{modelValue:i.operateForm.addr,"onUpdate:modelValue":l[9]||(l[9]=e=>i.operateForm.addr=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])):((0,t.wg)(),(0,t.iD)("span",r,"这是一段信息"))])),_:1},8,["modelValue"]),(0,t._)("div",n,[(0,t.Wm)(h,{type:"primary",onClick:l[13]||(l[13]=e=>(i.dialogVisible=!0,m.confirm))},{default:(0,t.w5)((()=>[(0,t.Uk)("新增")])),_:1}),(0,t.Wm)(g,{formLabel:i.formLabel,form:i.searchForm,inline:!0,ref:"form"},{default:(0,t.w5)((()=>[(0,t.Wm)(h,{type:"primary",onClick:l[14]||(l[14]=e=>m.getList(i.searchForm.keyword))},{default:(0,t.w5)((()=>[(0,t.Uk)("搜索")])),_:1})])),_:1},8,["formLabel","form"])]),(0,t.Wm)(b,{tableData:i.tableData,tableLabel:i.tableLabel,config:i.config,onChangePage:l[15]||(l[15]=e=>m.getList()),onEdit:m.editUser,onDel:m.delUser},null,8,["tableData","tableLabel","config","onEdit","onDel"])])}function i(e,l,a,o,r,n){const d=(0,t.up)("el-input"),i=(0,t.up)("el-switch"),m=(0,t.up)("el-date-picker"),s=(0,t.up)("el-option"),u=(0,t.up)("el-select"),p=(0,t.up)("el-form-item"),c=(0,t.up)("el-form");return(0,t.wg)(),(0,t.j4)(c,{ref:"form","label-width":"100px",model:r.internalForm,inline:a.inline},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(a.formLabel,(e=>((0,t.wg)(),(0,t.j4)(p,{key:e.label,label:e.label},{default:(0,t.w5)((()=>["input"===e.type?((0,t.wg)(),(0,t.j4)(d,{key:0,placeholder:"請輸入"+e.label,modelValue:r.internalForm[e.model],"onUpdate:modelValue":l=>r.internalForm[e.model]=l},null,8,["placeholder","modelValue","onUpdate:modelValue"])):(0,t.kq)("",!0),"switch"===e.type?((0,t.wg)(),(0,t.j4)(i,{key:1,modelValue:r.internalForm[e.model],"onUpdate:modelValue":l=>r.internalForm[e.model]=l},null,8,["modelValue","onUpdate:modelValue"])):(0,t.kq)("",!0),"date"===e.type?((0,t.wg)(),(0,t.j4)(m,{key:2,type:"date","value-format":"yyyy-MM-dd",placeholder:"選擇日期",modelValue:r.internalForm[e.model],"onUpdate:modelValue":l=>r.internalForm[e.model]=l},null,8,["modelValue","onUpdate:modelValue"])):(0,t.kq)("",!0),"select"===e.type?((0,t.wg)(),(0,t.j4)(u,{key:3,placeholder:"請選擇",modelValue:r.internalForm[e.model],"onUpdate:modelValue":l=>r.internalForm[e.model]=l},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.opts,((e,l)=>((0,t.wg)(),(0,t.j4)(s,{key:l,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"])):(0,t.kq)("",!0)])),_:2},1032,["label"])))),128)),(0,t.Wm)(p,null,{default:(0,t.w5)((()=>[(0,t.WI)(e.$slots,"default")])),_:3})])),_:3},8,["model","inline"])}var m={name:"CommonForm",props:{formLabel:Array,form:Object,inline:Boolean},data(){return{internalForm:{}}},watch:{form:{handler(e){this.internalForm={...e}},immediate:!0}}},s=a(89);const u=(0,s.Z)(m,[["render",i]]);var p=u,c=a(2268);const h={class:"common-table"};function f(e,l,a,o,r,n){const d=(0,t.up)("el-table-column"),i=(0,t.up)("el-button"),m=(0,t.up)("el-table"),s=(0,t.up)("el-pagination");return(0,t.wg)(),(0,t.iD)("div",h,[(0,t.Wm)(m,{data:a.tableData,height:"90%",stripe:""},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(a.tableLabel,(e=>((0,t.wg)(),(0,t.j4)(d,{key:e.prop,label:e.label,width:e.width?e.width:125,"show-overflow-tooltip":""},{default:(0,t.w5)((l=>[(0,t._)("span",null,(0,c.zw)(l.row[e.prop]),1)])),_:2},1032,["label","width"])))),128)),(0,t.Wm)(d,{label:"操作","min-width":"180"},{default:(0,t.w5)((e=>[(0,t.Wm)(i,{size:"small",onClick:l=>n.handleEdit(e.row)},{default:(0,t.w5)((()=>[(0,t.Uk)("編輯")])),_:2},1032,["onClick"]),(0,t.Wm)(i,{size:"small",type:"danger",onClick:l=>n.handelDelete(e.row)},{default:(0,t.w5)((()=>[(0,t.Uk)("刪除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),(0,t.Wm)(s,{class:"pager",layout:"prev, pager, next",total:a.config.total,"current-page":a.config.page,onCurrentChange:n.handelPageChange,"page-size":20},null,8,["total","current-page","onCurrentChange"])])}var g={name:"CommonTable",props:{tableData:Array,tableLabel:Array,config:Object},data(){return{}},methods:{handleEdit(e){this.$emit("edit",e)},handelDelete(e){this.$emit("del",e)},handelPageChange(e){this.$emit("newPage",e)}}};const b=(0,s.Z)(g,[["render",f],["__scopeId","data-v-74ffa3a8"]]);var w=b,V=a(2549),y={name:"UserView",components:{CommonForm:p,CommonTable:w},data(){return{dialogVisible:!1,operateType:"",form:{name:"",birth:"",age:"",sex:"",addr:""},operateForm:{name:"",birth:"",age:"",sex:"",addr:""},rules:{name:[{required:!0,message:"請輸入姓名"}],age:[{required:!0,message:"請輸入年齡"}],sex:[{required:!0,message:"請選擇性別"}],birth:[{required:!0,message:"請選擇出生日期"}],addr:[{required:!0,message:"請輸入地址"}]},formLabel:[{model:"keyword",label:"",type:"input"}],searchForm:{keyword:""},tableData:[],tableLabel:[{prop:"id",label:"id",width:300},{prop:"name",label:"姓名"},{prop:"sex",label:"性別"},{prop:"birth",label:"出生日期",width:200},{prop:"age",label:"年齡"},{prop:"addr",label:"地址",width:400}],config:{page:1,total:30}}},methods:{handleClose(){this.$refs.addForm&&this.$refs.addForm.resetFields(),this.$refs.editForm&&this.$refs.editForm.resetFields(),this.dialogVisible=!1},cancel(){this.handleClose(),this.$message("取消操作")},addUser(){this.operateType="add",this.form={name:"",age:"",sex:"",birth:"",addr:""},this.dialogVisible=!0},editUser(e){this.operateType="edit",this.operateForm=Object.assign({},e),this.dialogVisible=!0},delUser(e){this.$confirm("此操作將永久刪除該資料，是否繼續？","提示",{confirmButtonText:"確認",cancelButtonText:"取消",type:"warning"}).then((()=>{const l=e.id;return this.$http.post("user/del",{id:l})})).then((()=>{this.getList(),this.$message.success("用戶已刪除")})).catch((e=>{console.log("刪除操作取消",e)}))},getList(e=""){console.log("Search keyword:",e),this.config.loading=!0,e&&(this.config.page=1),(0,V.PR)({page:this.config.page,name:e}).then((({data:e})=>{console.log(e,"res"),this.tableData=e.list.map((e=>(e.sex=0===e.sex?"女":"男",e))),this.config.total=e.count,this.config.loading=!1}))},confirm(){let e="edit"===this.operateType?this.$refs.editForm:this.$refs.addForm;e&&e.validate((e=>{if(e){const e="edit"===this.operateType?"/user/edit":"/user/add",l="edit"===this.operateType?this.operateForm:this.form;this.$http.post(e,l).then((()=>{this.dialogVisible=!1,this.getList(),this.$message.success("操作成功")})).catch((e=>{console.error("Error:",e),this.$message.error("操作失敗")}))}}))}},created(){this.getList()}};const k=(0,s.Z)(y,[["render",d],["__scopeId","data-v-f8803624"]]);var F=k}}]);
//# sourceMappingURL=174.f457dc83.js.map