{"ast":null,"code":"import { createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, createElementVNode as _createElementVNode, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, createElementBlock as _createElementBlock, Fragment as _Fragment, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-4498f7b0\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  class: \"manage\"\n};\nconst _hoisted_2 = {\n  class: \"manage-header\"\n};\nconst _hoisted_3 = {\n  key: 2\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_el_button = _resolveComponent(\"el-button\");\n  const _component_common_form = _resolveComponent(\"common-form\");\n  const _component_common_table = _resolveComponent(\"common-table\");\n  const _component_el_input = _resolveComponent(\"el-input\");\n  const _component_el_form_item = _resolveComponent(\"el-form-item\");\n  const _component_el_form = _resolveComponent(\"el-form\");\n  const _component_el_dialog = _resolveComponent(\"el-dialog\");\n  return _openBlock(), _createElementBlock(_Fragment, null, [_createElementVNode(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_createVNode(_component_el_button, {\n    type: \"primary\",\n    onClick: _cache[0] || (_cache[0] = $event => ($data.dialogVisible = true, $options.confirm))\n  }, {\n    default: _withCtx(() => [_createTextVNode(\"新增\")]),\n    _: 1 /* STABLE */\n  }), _createVNode(_component_common_form, {\n    formLabel: $data.formLabel,\n    form: $data.searchForm,\n    inline: true,\n    ref: \"form\"\n  }, {\n    default: _withCtx(() => [_createVNode(_component_el_button, {\n      type: \"primary\",\n      onClick: _cache[1] || (_cache[1] = $event => $options.getList($data.searchForm.keyword))\n    }, {\n      default: _withCtx(() => [_createTextVNode(\"搜索\")]),\n      _: 1 /* STABLE */\n    })]),\n\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"formLabel\", \"form\"])]), _createVNode(_component_common_table, {\n    tableData: $data.tableData,\n    tableLabel: $data.tableLabel,\n    config: $data.config,\n    onChangePage: _cache[2] || (_cache[2] = $event => $options.getList()),\n    onEdit: $options.editUser,\n    onDel: $options.delUser\n  }, null, 8 /* PROPS */, [\"tableData\", \"tableLabel\", \"config\", \"onEdit\", \"onDel\"])]), _createVNode(_component_el_dialog, {\n    title: \"提示\",\n    visible: $data.dialogVisible,\n    \"onUpdate:visible\": _cache[9] || (_cache[9] = $event => $data.dialogVisible = $event)\n  }, {\n    footer: _withCtx(() => [_createVNode(_component_el_button, {\n      onClick: _cache[7] || (_cache[7] = $event => $data.dialogVisible = false)\n    }, {\n      default: _withCtx(() => [_createTextVNode(\"取 消\")]),\n      _: 1 /* STABLE */\n    }), _createVNode(_component_el_button, {\n      type: \"primary\",\n      onClick: _cache[8] || (_cache[8] = $event => ($data.dialogVisible = false, $options.confirm))\n    }, {\n      default: _withCtx(() => [_createTextVNode(\"确 定\")]),\n      _: 1 /* STABLE */\n    })]),\n\n    default: _withCtx(() => [_ctx.operateType === 'add' ? (_openBlock(), _createBlock(_component_el_form, {\n      key: 0,\n      model: $data.form\n    }, {\n      default: _withCtx(() => [_createVNode(_component_el_form_item, {\n        label: \"姓名\",\n        prop: \"name\"\n      }, {\n        default: _withCtx(() => [_createVNode(_component_el_input, {\n          modelValue: _ctx.operateForm.name,\n          \"onUpdate:modelValue\": _cache[3] || (_cache[3] = $event => _ctx.operateForm.name = $event)\n        }, null, 8 /* PROPS */, [\"modelValue\"])]),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_el_form_item, {\n        label: \"年龄\",\n        prop: \"age\"\n      }, {\n        default: _withCtx(() => [_createVNode(_component_el_input, {\n          modelValue: _ctx.operateForm.age,\n          \"onUpdate:modelValue\": _cache[4] || (_cache[4] = $event => _ctx.operateForm.age = $event)\n        }, null, 8 /* PROPS */, [\"modelValue\"])]),\n        _: 1 /* STABLE */\n      })]),\n\n      _: 1 /* STABLE */\n    }, 8 /* PROPS */, [\"model\"])) : _createCommentVNode(\"v-if\", true), _ctx.operateType === 'edit' ? (_openBlock(), _createBlock(_component_el_form, {\n      key: 1,\n      model: _ctx.operateForm\n    }, {\n      default: _withCtx(() => [_createVNode(_component_el_form_item, {\n        label: \"姓名\",\n        prop: \"name\"\n      }, {\n        default: _withCtx(() => [_createVNode(_component_el_input, {\n          modelValue: _ctx.operateForm.name,\n          \"onUpdate:modelValue\": _cache[5] || (_cache[5] = $event => _ctx.operateForm.name = $event)\n        }, null, 8 /* PROPS */, [\"modelValue\"])]),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_el_form_item, {\n        label: \"年龄\",\n        prop: \"age\"\n      }, {\n        default: _withCtx(() => [_createVNode(_component_el_input, {\n          modelValue: _ctx.operateForm.age,\n          \"onUpdate:modelValue\": _cache[6] || (_cache[6] = $event => _ctx.operateForm.age = $event)\n        }, null, 8 /* PROPS */, [\"modelValue\"])]),\n        _: 1 /* STABLE */\n      })]),\n\n      _: 1 /* STABLE */\n    }, 8 /* PROPS */, [\"model\"])) : (_openBlock(), _createElementBlock(\"span\", _hoisted_3, \"这是一段信息\"))]),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"visible\"])], 64 /* STABLE_FRAGMENT */);\n}","map":{"version":3,"names":["class","_createElementVNode","_hoisted_1","_hoisted_2","_createVNode","_component_el_button","type","onClick","_cache","$event","$data","dialogVisible","$options","confirm","_component_common_form","formLabel","form","searchForm","inline","ref","getList","keyword","_component_common_table","tableData","tableLabel","config","onChangePage","onEdit","editUser","onDel","delUser","_component_el_dialog","title","visible","footer","_withCtx","_ctx","operateType","_createBlock","_component_el_form","model","_component_el_form_item","label","prop","_component_el_input","operateForm","name","age","_createElementBlock","_hoisted_3"],"sources":["/Users/serina/Desktop/vue-backstage/src/views/user/index.vue"],"sourcesContent":["<template>\n    <div class=\"manage\">\n        <div class=\"manage-header\">\n            <el-button type=\"primary\" @click=\"dialogVisible = true, confirm\">新增</el-button>\n            <common-form\n            :formLabel=\"formLabel\"\n            :form=\"searchForm\"\n                :inline=\"true\"\n                ref=\"form\"\n            >\n                <el-button type=\"primary\" @click=\"getList(searchForm.keyword)\">搜索</el-button>\n            </common-form>\n        </div>\n        <common-table\n        :tableData=\"tableData\"\n        :tableLabel=\"tableLabel\"\n        :config=\"config\"\n        @changePage=\"getList()\"\n        @edit=\"editUser\"\n        @del=\"delUser\"\n        ></common-table>\n    </div>\n    <el-dialog\n        title=\"提示\"\n        v-model:visible=\"dialogVisible\"\n        >\n        <template v-if=\"operateType === 'add'\">\n            <el-form :model=\"form\">\n                <el-form-item label=\"姓名\" prop=\"name\">\n                    <el-input v-model=\"operateForm.name\"></el-input>\n                </el-form-item>\n                <el-form-item label=\"年龄\" prop=\"age\">\n                    <el-input v-model=\"operateForm.age\"></el-input>\n                </el-form-item>\n            </el-form>\n        </template>\n        <template v-if=\"operateType === 'edit'\">\n            <el-form :model=\"operateForm\">\n                <el-form-item label=\"姓名\" prop=\"name\">\n                    <el-input v-model=\"operateForm.name\"></el-input>\n                </el-form-item>\n                <el-form-item label=\"年龄\" prop=\"age\">\n                    <el-input v-model=\"operateForm.age\"></el-input>\n                </el-form-item>\n            </el-form>\n        </template>\n        <template v-else>\n            <span>这是一段信息</span>\n        </template>\n        <template #footer>\n            <el-button @click=\"dialogVisible = false\">取 消</el-button>\n            <el-button type=\"primary\" @click=\"dialogVisible = false, confirm\">确 定</el-button>\n        </template>\n        </el-dialog>\n</template>\n<script>\nimport CommonForm from '@/components/CommonForm.vue';\nimport CommonTable from '@/components/CommonTable.vue';\nimport { getUser } from '../../api/data.js';\nexport default {\n    name: 'UserView',\n    components: {\n        CommonForm,\n        CommonTable\n    },\n    data() {\n        return {\n            dialogVisible: false,\n            operateFormLabel: [\n                {\n                    model: 'name',\n                    label: '姓名',\n                    type: 'input'\n                },\n                {\n                    model: 'age',\n                    label: '年齡',\n                    type: 'input'\n                }, \n                {\n                    model: 'sex',\n                    label: '性別',\n                    type: 'select',\n                    opts: [\n                        {\n                            label: '男',\n                            value: 1\n                        },\n                        {\n                            label: '女',\n                            value: 2\n                        }\n                    ]\n                },\n                {\n                    model: 'birth',\n                    label: '出生日期',\n                    type: 'date'\n                },\n                {\n                    model: 'add',\n                    label: '地址',\n                    type: 'input'\n                }\n            ],\n            form: {\n                name: '',\n                birth: '',\n                age: '',\n                sex: '',\n                addr: '',\n            },\n            rules: {\n                name: [{require: true, message: \"請輸入姓名\"}],\n                age: [{require: true, message: \"請輸入年齡\"}],\n                sex: [{require: true, message: \"請選擇性別\"}],\n                birth: [{require: true, message: \"請選擇出生日期\"}],\n                addr: [{require: true, message: \"請輸入地址\"}],\n            },\n            formLabel: [\n                {\n                    model: 'keyword',\n                    label: '',\n                    type: 'input'\n                }\n            ],\n            searchForm: {\n                keyword: ''\n            },\n            tableData: [],\n            tableLabel: [\n                {\n                    prop: \"id\",\n                    label: \"id\",\n                    width: 300\n                },\n                {\n                    prop: \"name\",\n                    label: \"姓名\"\n                },\n                {\n                    prop: \"sex\",\n                    label: \"性別\"\n                },\n                {\n                    prop: \"birth\",\n                    label: \"出生日期\",\n                    width: 200\n                },\n                {\n                    prop: \"age\",\n                    label: \"年齡\"\n                },\n                {\n                    prop: \"addr\",\n                    label: \"地址\",\n                    width: 400\n                }\n            ],\n            config: {\n                page: 1,\n                total: 30\n            }\n        };\n    },\n    methods: {\n        confirm() { //提交表單判斷是哪種操作\n            this.$refs.form.validate(() => {\n                if (this.operateType === 'edit'){\n                    return this.$http.post('/user/edit', this.operateForm)\n                    .then(res => {\n                        console.log(res);\n                        this.dialogVisible = false;\n                        this.getList();\n                    })\n                } else {\n                    return this.$http.post('/user/add', this.operateForm).\n                    then(res => {\n                        console.log(res);\n                        this.dialogVisible = false;\n                        this.getList();\n                    })\n                }\n            })\n        },\n        handleClose() {\n            //彈窗關閉的時候清空表單\n            this.$ref.from.resetFields();\n            this.dialogVisible = false;\n        },\n        cancel() {\n            this.handleClose();\n            this.$message('取消操作');\n        },\n        addUser() {\n            this.dialogVisible= true;\n            this.operateType='add'\n            this.operateForm = {\n                name: '',\n                addr: '',\n                age: '',\n                birth: '',\n                sex: ''\n            }\n        },\n        editUser(row){\n            console.log(\"Editing user\", row);\n            this.operateType = 'edit';\n            console.log(\"Operate Type after setting:\", this.operateType);\n            this.dialogVisible = true;\n            this.operateForm = row;\n        },\n        delUser (row){\n            this.$confirm(\"此操作將永久刪除該資料，是否繼續？\", \"提示\", {\n                confirmButtonText: \"確認\",\n                cancelButtonText: \"取消\",\n                type: \"warning\"\n            }).then(() => {\n                const id = row.id;\n                return this.$http.post(\"user/del\", { id: id });\n            }).then(() => {\n                this.getList();\n                this.$message.success('用戶已刪除');\n            }).catch(err => {\n                console.log(\"刪除操作取消\", err);\n                \n            })\n        },\n        getList(name = ''){\n            console.log('Search keyword:', name);\n            this.config.loading = true;\n            name ? (this.config.page = 1) : '';\n            getUser({\n                page: this.config.page,\n                name\n            }).then(({data: res}) => {\n                console.log(res, 'res');\n                this.tableData = res.list.map(item => {\n                    item.sex = item.sex === 0 ? \"女\": \"男\"\n                    return item \n                })\n                this.config.total = res.count;\n                this.config.loading = false;\n            });\n        }\n    },\n    created() {\n        this.getList();\n    }\n}\n\n</script>\n\n<style lang=\"less\" scoped>\n    .manage-header {\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n    }\n</style>"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}