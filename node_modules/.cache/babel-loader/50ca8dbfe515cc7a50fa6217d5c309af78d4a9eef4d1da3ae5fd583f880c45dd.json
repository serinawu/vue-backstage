{"ast":null,"code":"import CommonForm from '@/components/CommonForm.vue';\nimport CommonTable from '@/components/CommonTable.vue';\nimport { getMockUser } from '@/api/data.js';\nexport default {\n  name: 'UserView',\n  components: {\n    CommonForm,\n    CommonTable\n  },\n  data() {\n    return {\n      dialogVisible: false,\n      operateType: '',\n      form: {\n        name: '',\n        birth: '',\n        age: '',\n        sex: '',\n        addr: ''\n      },\n      operateForm: {\n        name: '',\n        birth: '',\n        age: '',\n        sex: '',\n        addr: ''\n      },\n      rules: {\n        name: [{\n          required: true,\n          message: \"請輸入姓名\"\n        }],\n        age: [{\n          required: true,\n          message: \"請輸入年齡\"\n        }],\n        sex: [{\n          required: true,\n          message: \"請選擇性別\"\n        }],\n        birth: [{\n          required: true,\n          message: \"請選擇出生日期\"\n        }],\n        addr: [{\n          required: true,\n          message: \"請輸入地址\"\n        }]\n      },\n      formLabel: [{\n        model: 'keyword',\n        label: '',\n        type: 'input'\n      }],\n      searchForm: {\n        keyword: ''\n      },\n      tableData: [],\n      tableLabel: [{\n        prop: \"createdAt\",\n        label: \"帳號創建日期\",\n        width: 300\n      }, {\n        prop: \"name\",\n        label: \"姓名\"\n      }, {\n        prop: \"sex\",\n        label: \"性別\"\n      }, {\n        prop: \"birth\",\n        label: \"出生日期\",\n        width: 200\n      }, {\n        prop: \"phone\",\n        label: \"電話\"\n      }, {\n        prop: \"address\",\n        label: \"地址\",\n        width: 400\n      }],\n      config: {\n        page: 1,\n        total: 30\n      }\n    };\n  },\n  methods: {\n    handleClose() {\n      //彈窗關閉的時候清空表單\n      this.$refs.addForm && this.$refs.addForm.resetFields();\n      this.$refs.editForm && this.$refs.editForm.resetFields();\n      this.dialogVisible = false;\n    },\n    cancel() {\n      this.handleClose();\n      this.$message('取消操作');\n    },\n    addUser() {\n      this.operateType = 'add';\n      this.form = {\n        name: '',\n        age: '',\n        sex: '',\n        birth: '',\n        addr: ''\n      };\n      this.dialogVisible = true;\n    },\n    editUser(row) {\n      this.operateType = 'edit';\n      this.operateForm = Object.assign({}, row);\n      this.dialogVisible = true;\n    },\n    delUser(row) {\n      this.$confirm(\"此操作將永久刪除該資料，是否繼續？\", \"提示\", {\n        confirmButtonText: \"確認\",\n        cancelButtonText: \"取消\",\n        type: \"warning\"\n      }).then(() => {\n        const id = row.id;\n        return this.$http.post(\"user/del\", {\n          id: id\n        });\n      }).then(() => {\n        this.getList();\n        this.$message.success('用戶已刪除');\n      }).catch(err => {\n        console.log(\"刪除操作取消\", err);\n      });\n    },\n    getList(name = '') {\n      console.log('Search keyword:', name);\n      this.config.loading = true;\n      name ? this.config.page = 1 : '';\n      getMockUser({\n        page: this.config.page,\n        name\n      }).then(response => {\n        const res = response.data;\n        if (res && Array.isArray(res)) {\n          this.tableData = res.map(item => {\n            item.sex = item.sex === \"female\" ? \"女\" : \"男\";\n            return item;\n          });\n          this.config.total = res.length;\n        } else {\n          throw new Error(`Expected res to be an array but received: ${typeof res}`);\n        }\n        this.config.loading = false;\n      }).catch(error => {\n        console.error('Error fetching data:', error);\n        this.config.loading = false;\n      });\n    },\n    confirm() {\n      //提交表單判斷是哪種操作\n      let formToValidate = this.operateType === 'edit' ? this.$refs.editForm : this.$refs.addForm;\n      if (formToValidate) {\n        formToValidate.validate(valid => {\n          if (valid) {\n            const url = this.operateType === 'edit' ? '/user/edit' : '/user/add';\n            const data = this.operateType === 'edit' ? this.operateForm : this.form;\n            this.$http.post(url, data).then(() => {\n              this.dialogVisible = false;\n              this.getList();\n              this.$message.success('操作成功');\n            }).catch(error => {\n              console.error('Error:', error);\n              this.$message.error('操作失敗');\n            });\n          }\n        });\n      }\n    }\n  },\n  created() {\n    this.getList();\n  }\n};","map":{"version":3,"names":["CommonForm","CommonTable","getMockUser","name","components","data","dialogVisible","operateType","form","birth","age","sex","addr","operateForm","rules","required","message","formLabel","model","label","type","searchForm","keyword","tableData","tableLabel","prop","width","config","page","total","methods","handleClose","$refs","addForm","resetFields","editForm","cancel","$message","addUser","editUser","row","Object","assign","delUser","$confirm","confirmButtonText","cancelButtonText","then","id","$http","post","getList","success","catch","err","console","log","loading","response","res","Array","isArray","map","item","length","Error","error","confirm","formToValidate","validate","valid","url","created"],"sources":["/Users/serina/Desktop/vue-backstage/src/views/user/index.vue"],"sourcesContent":["<template>\n    <div class=\"manage\">\n        <el-dialog\n        title=\"提示\"\n        v-model=\"dialogVisible\"\n        width=\"40%\"\n        >\n        <template v-if=\"operateType === 'add'\">\n            <!-- 新增用户的表单 -->\n            <el-form :model=\"form\" :rules=\"rules\" ref=\"addForm\" :inline=\"true\">\n                <el-form-item label=\"姓名\" prop=\"name\">\n                    <el-input v-model=\"form.name\"></el-input>\n                </el-form-item>\n                <el-form-item label=\"性別\" prop=\"sex\">\n                    <el-input v-model=\"form.sex\"></el-input>\n                </el-form-item>\n                <el-form-item label=\"年龄\" prop=\"age\">\n                    <el-input v-model=\"form.age\"></el-input>\n                </el-form-item>\n                <el-form-item label=\"出生日期\" prop=\"birth\">\n                    <el-date-picker v-model=\"form.birth\"></el-date-picker>\n                </el-form-item>\n                <el-form-item label=\"地址\" prop=\"addr\">\n                    <el-input v-model=\"form.addr\"></el-input>\n                </el-form-item>\n            </el-form>\n        </template>\n        <template v-else-if=\"operateType === 'edit'\">\n            <!-- 编辑用户的表单 -->\n            <el-form :model=\"operateForm\" ref=\"editForm\" :inline=\"true\">\n                <el-form-item label=\"姓名\" prop=\"name\">\n                    <el-input v-model=\"operateForm.name\"></el-input>\n                </el-form-item>\n                <el-form-item label=\"性別\" prop=\"sex\">\n                    <el-input v-model=\"operateForm.sex\"></el-input>\n                </el-form-item>\n                <el-form-item label=\"年龄\" prop=\"age\">\n                    <el-input v-model=\"operateForm.age\"></el-input>\n                </el-form-item>\n                <el-form-item label=\"出生日期\" prop=\"birth\">\n                    <el-date-picker v-model=\"operateForm.birth\"></el-date-picker>\n                </el-form-item>\n                <el-form-item label=\"地址\" prop=\"addr\">\n                    <el-input v-model=\"operateForm.addr\"></el-input>\n                </el-form-item>\n            </el-form>\n        </template>\n        <span v-else>这是一段信息</span>\n        <template #footer>\n            <el-button @click=\"dialogVisible = false\">取 消</el-button>\n            <el-button type=\"primary\" @click=\"dialogVisible = false, confirm()\">确 定</el-button>\n        </template>\n        </el-dialog>\n        <div class=\"manage-header\">\n            <el-button type=\"primary\" @click=\"dialogVisible = true, confirm\">新增</el-button>\n            <common-form\n            :formLabel=\"formLabel\"\n            :form=\"searchForm\"\n                :inline=\"true\"\n                ref=\"form\"\n            >\n                <el-button type=\"primary\" @click=\"getList(searchForm.keyword)\">搜索</el-button>\n            </common-form>\n        </div>\n        <common-table\n        :tableData=\"tableData\"\n        :tableLabel=\"tableLabel\"\n        :config=\"config\"\n        @changePage=\"getList()\"\n        @edit=\"editUser\"\n        @del=\"delUser\"\n        ></common-table>\n    </div>\n</template>\n<script>\nimport CommonForm from '@/components/CommonForm.vue';\nimport CommonTable from '@/components/CommonTable.vue';\nimport { getMockUser } from '@/api/data.js';\nexport default {\n    name: 'UserView',\n    components: {\n        CommonForm,\n        CommonTable\n    },\n    data() {\n        return {\n            dialogVisible: false,\n            operateType: '',\n            form: {\n                name: '',\n                birth: '',\n                age: '',\n                sex: '',\n                addr: '',\n            },\n            operateForm: {\n                name: '',\n                birth: '',\n                age: '',\n                sex: '',\n                addr: '',\n            },\n            rules: {\n                name: [{required: true, message: \"請輸入姓名\"}],\n                age: [{required: true, message: \"請輸入年齡\"}],\n                sex: [{required: true, message: \"請選擇性別\"}],\n                birth: [{required: true, message: \"請選擇出生日期\"}],\n                addr: [{required: true, message: \"請輸入地址\"}],\n            },\n            formLabel: [\n                {\n                    model: 'keyword',\n                    label: '',\n                    type: 'input'\n                }\n            ],\n            searchForm: {\n                keyword: ''\n            },\n            tableData: [],\n            tableLabel: [\n                {\n                    prop: \"createdAt\",\n                    label: \"帳號創建日期\",\n                    width: 300\n                },\n                {\n                    prop: \"name\",\n                    label: \"姓名\"\n                },\n                {\n                    prop: \"sex\",\n                    label: \"性別\"\n                },\n                {\n                    prop: \"birth\",\n                    label: \"出生日期\",\n                    width: 200\n                },\n                {\n                    prop: \"phone\",\n                    label: \"電話\"\n                },\n                {\n                    prop: \"address\",\n                    label: \"地址\",\n                    width: 400\n                }\n            ],\n            config: {\n                page: 1,\n                total: 30\n            }\n        };\n    },\n    methods: {\n        handleClose() {\n            //彈窗關閉的時候清空表單\n            this.$refs.addForm && this.$refs.addForm.resetFields();\n            this.$refs.editForm && this.$refs.editForm.resetFields();\n            this.dialogVisible = false;\n        },\n        cancel() {\n            this.handleClose();\n            this.$message('取消操作');\n        },\n        addUser() {\n            this.operateType = 'add';\n            this.form = {\n                name: '',\n                age: '',\n                sex: '',\n                birth: '',\n                addr: '',\n            };\n            this.dialogVisible = true;\n        },\n        editUser(row){\n            this.operateType = 'edit';\n            this.operateForm = Object.assign({}, row);\n            this.dialogVisible = true;\n        },\n        delUser (row){\n            this.$confirm(\"此操作將永久刪除該資料，是否繼續？\", \"提示\", {\n                confirmButtonText: \"確認\",\n                cancelButtonText: \"取消\",\n                type: \"warning\"\n            }).then(() => {\n                const id = row.id;\n                return this.$http.post(\"user/del\", { id: id });\n            }).then(() => {\n                this.getList();\n                this.$message.success('用戶已刪除');\n            }).catch(err => {\n                console.log(\"刪除操作取消\", err);\n                \n            }) },\n        getList(name = ''){\n            console.log('Search keyword:', name);\n            this.config.loading = true;\n            name ? (this.config.page = 1) : '';\n            getMockUser({\n                page: this.config.page,\n                name\n            }).then(response => {\n               const res = response.data;\n               if(res && Array.isArray(res)) {\n                this.tableData = res.map(item => {\n                    item.sex = item.sex === \"female\" ? \"女\" : \"男\";\n                 return item;\n                });\n                this.config.total = res.length;\n               } else {\n                throw new Error(`Expected res to be an array but received: ${typeof res}`);\n               }\n               this.config.loading = false;\n            }).catch(error => {\n                console.error('Error fetching data:', error);\n                this.config.loading = false;\n            });\n        },\n        confirm() { //提交表單判斷是哪種操作\n            let formToValidate = this.operateType === 'edit' ? this.$refs.editForm : this.$refs.addForm;\n            if (formToValidate) {\n                formToValidate.validate((valid) => {\n                    if (valid) {\n                        const url = this.operateType === 'edit' ? '/user/edit' : '/user/add';\n                        const data = this.operateType === 'edit' ? this.operateForm : this.form;\n                        this.$http.post(url, data)\n                            .then(() => {\n                                this.dialogVisible = false;\n                                this.getList();\n                                this.$message.success('操作成功');\n                            })\n                            .catch(error => {\n                                console.error('Error:', error);\n                                this.$message.error('操作失敗');\n                            });\n                    }\n                });\n            }\n        },\n    },\n    created() {\n        this.getList();\n    }\n}\n\n</script>\n\n<style lang=\"less\" scoped>\n    .manage-header {\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n    }\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}