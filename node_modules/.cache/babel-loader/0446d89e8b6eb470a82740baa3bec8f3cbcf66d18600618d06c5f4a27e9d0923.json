{"ast":null,"code":"import CommonForm from '@/components/CommonForm.vue';\nimport CommonTable from '@/components/CommonTable.vue';\nimport { getUser } from '../../api/data.js';\nexport default {\n  name: 'UserView',\n  components: {\n    CommonForm,\n    CommonTable\n  },\n  data() {\n    return {\n      dialogVisible: false,\n      operateFormLabel: [{\n        model: 'name',\n        label: '姓名',\n        type: 'input'\n      }, {\n        model: 'age',\n        label: '年齡',\n        type: 'input'\n      }, {\n        model: 'sex',\n        label: '性別',\n        type: 'select',\n        opts: [{\n          label: '男',\n          value: 1\n        }, {\n          label: '女',\n          value: 2\n        }]\n      }, {\n        model: 'birth',\n        label: '出生日期',\n        type: 'date'\n      }, {\n        model: 'add',\n        label: '地址',\n        type: 'input'\n      }],\n      form: {\n        name: '',\n        birth: '',\n        age: '',\n        sex: '',\n        addr: ''\n      },\n      formLabel: [{\n        model: 'keyword',\n        label: '',\n        type: 'input'\n      }],\n      searchForm: {\n        keyword: ''\n      },\n      tableData: [],\n      tableLabel: [{\n        prop: \"id\",\n        label: \"id\",\n        width: 300\n      }, {\n        prop: \"name\",\n        label: \"姓名\"\n      }, {\n        prop: \"sex\",\n        label: \"性別\"\n      }, {\n        prop: \"birth\",\n        label: \"出生日期\",\n        width: 200\n      }, {\n        prop: \"age\",\n        label: \"年齡\"\n      }, {\n        prop: \"addr\",\n        label: \"地址\",\n        width: 400\n      }],\n      config: {\n        page: 1,\n        total: 30\n      }\n    };\n  },\n  methods: {\n    handleClose() {\n      //彈窗關閉的時候清空表單\n      this.$ref.from.resetFields();\n      this.dialogVisible = false;\n    },\n    cancel() {\n      this.handleClose();\n      this.$message('取消刪除');\n    },\n    confirm() {\n      //提交表單判斷是哪種操作\n      if (this.operateType === 'edit') {\n        this.$http.post('/user/edit', this.operateForm).then(res => {\n          console.log(res);\n          this.dialogVisible = false;\n          this.getList();\n        });\n      } else {\n        this.$http.post('/user/add', this.operateForm).then(res => {\n          console.log(res);\n          this.dialogVisible = false;\n          this.getList();\n        });\n      }\n    },\n    addUser() {\n      this.dialogVisible = true;\n      this.operateType = 'add';\n      this.operateForm = {\n        name: '',\n        addr: '',\n        age: '',\n        birth: '',\n        sex: ''\n      };\n    },\n    editUser(row) {\n      console.log(\"Editing user\", row);\n      this.operateType = 'edit';\n      console.log(\"Operate Type after setting:\", this.operateType);\n      this.dialogVisible = true;\n      this.operateForm = row;\n    },\n    delUser(row) {\n      this.$confirm(\"此操作將永久刪除該資料，是否繼續？\", \"提示\", {\n        confirmButtonText: \"確認\",\n        cancelButtonText: \"取消\",\n        type: \"warning\"\n      }).then(() => {\n        const id = row.id;\n        return this.$http.post(\"user/del\", {\n          id: id\n        });\n      }).then(() => {\n        this.getList();\n        this.$message.success('用戶已刪除');\n      }).catch(err => {\n        console.log(\"刪除操作取消\", err);\n      });\n    },\n    getList(name = '') {\n      console.log('Search keyword:', name);\n      this.config.loading = true;\n      name ? this.config.page = 1 : '';\n      getUser({\n        page: this.config.page,\n        name\n      }).then(({\n        data: res\n      }) => {\n        console.log(res, 'res');\n        this.tableData = res.list.map(item => {\n          item.sex = item.sex === 0 ? \"女\" : \"男\";\n          return item;\n        });\n        this.config.total = res.count;\n        this.config.loading = false;\n      });\n    }\n  },\n  created() {\n    this.getList();\n  }\n};","map":{"version":3,"names":["CommonForm","CommonTable","getUser","name","components","data","dialogVisible","operateFormLabel","model","label","type","opts","value","form","birth","age","sex","addr","formLabel","searchForm","keyword","tableData","tableLabel","prop","width","config","page","total","methods","handleClose","$ref","from","resetFields","cancel","$message","confirm","operateType","$http","post","operateForm","then","res","console","log","getList","addUser","editUser","row","delUser","$confirm","confirmButtonText","cancelButtonText","id","success","catch","err","loading","list","map","item","count","created"],"sources":["/Users/serina/Desktop/vue-backstage/src/views/user/index.vue"],"sourcesContent":["<template>\n    <div class=\"manage\">\n        <el-dialog\n        title=\"提示\"\n        v-model:visible=\"dialogVisible\"\n        >\n        <template v-if=\"operateType === 'edit'\">\n            <el-form :model=\"operateForm\">\n                <el-form-item label=\"姓名\" prop=\"name\">\n                    <el-input v-model=\"operateForm.name\"></el-input>\n                </el-form-item>\n                <el-form-item label=\"年龄\" prop=\"age\">\n                    <el-input v-model=\"operateForm.age\"></el-input>\n                </el-form-item>\n            </el-form>\n        </template>\n        <template v-else>\n            <span>这是一段信息</span>\n        </template>\n        <template #footer>\n            <el-button @click=\"dialogVisible = false\">取 消</el-button>\n            <el-button type=\"primary\" @click=\"dialogVisible = false, confirm\">确 定</el-button>\n        </template>\n        </el-dialog>\n        <div class=\"manage-header\">\n            <el-button type=\"primary\" plain @click=\"dialogVisible = true\">新增</el-button>\n            <common-form\n            :formLabel=\"formLabel\"\n            :form=\"searchForm\"\n                :inline=\"true\"\n                ref=\"form\"\n            >\n                <el-button type=\"primary\" @click=\"getList(searchForm.keyword)\">搜索</el-button>\n            </common-form>\n        </div>\n        <common-table\n        :tableData=\"tableData\"\n        :tableLabel=\"tableLabel\"\n        :config=\"config\"\n        @changePage=\"getList()\"\n        @edit=\"editUser\"\n        @del=\"delUser\"\n        ></common-table>\n    </div>\n</template>\n<script>\nimport CommonForm from '@/components/CommonForm.vue';\nimport CommonTable from '@/components/CommonTable.vue';\nimport { getUser } from '../../api/data.js';\nexport default {\n    name: 'UserView',\n    components: {\n        CommonForm,\n        CommonTable\n    },\n    data() {\n        return {\n            dialogVisible: false,\n            operateFormLabel: [\n                {\n                    model: 'name',\n                    label: '姓名',\n                    type: 'input'\n                },\n                {\n                    model: 'age',\n                    label: '年齡',\n                    type: 'input'\n                }, \n                {\n                    model: 'sex',\n                    label: '性別',\n                    type: 'select',\n                    opts: [\n                        {\n                            label: '男',\n                            value: 1\n                        },\n                        {\n                            label: '女',\n                            value: 2\n                        }\n                    ]\n                },\n                {\n                    model: 'birth',\n                    label: '出生日期',\n                    type: 'date'\n                },\n                {\n                    model: 'add',\n                    label: '地址',\n                    type: 'input'\n                }\n            ],\n            form: {\n                name: '',\n                birth: '',\n                age: '',\n                sex: '',\n                addr: '',\n            },\n            formLabel: [\n                {\n                    model: 'keyword',\n                    label: '',\n                    type: 'input'\n                }\n            ],\n            searchForm: {\n                keyword: ''\n            },\n            tableData: [],\n            tableLabel: [\n                {\n                    prop: \"id\",\n                    label: \"id\",\n                    width: 300\n                },\n                {\n                    prop: \"name\",\n                    label: \"姓名\"\n                },\n                {\n                    prop: \"sex\",\n                    label: \"性別\"\n                },\n                {\n                    prop: \"birth\",\n                    label: \"出生日期\",\n                    width: 200\n                },\n                {\n                    prop: \"age\",\n                    label: \"年齡\"\n                },\n                {\n                    prop: \"addr\",\n                    label: \"地址\",\n                    width: 400\n                }\n            ],\n            config: {\n                page: 1,\n                total: 30\n            }\n        };\n    },\n    methods: {\n        handleClose() {\n            //彈窗關閉的時候清空表單\n            this.$ref.from.resetFields();\n            this.dialogVisible = false;\n        },\n        cancel() {\n            this.handleClose();\n            this.$message('取消刪除');\n        },\n        confirm() { //提交表單判斷是哪種操作\n            if (this.operateType === 'edit'){\n                this.$http.post('/user/edit', this.operateForm).then(res => {\n                    console.log(res);\n                    this.dialogVisible = false;\n                    this.getList();\n                })\n            } else {\n                this.$http.post('/user/add', this.operateForm).then(res => {\n                    console.log(res);\n                    this.dialogVisible = false;\n                    this.getList();\n                })\n            }\n        },\n        addUser() {\n            this.dialogVisible= true;\n            this.operateType='add'\n            this.operateForm = {\n                name: '',\n                addr: '',\n                age: '',\n                birth: '',\n                sex: ''\n            }\n        },\n        editUser(row){\n            console.log(\"Editing user\", row);\n            this.operateType = 'edit';\n            console.log(\"Operate Type after setting:\", this.operateType);\n            this.dialogVisible = true;\n            this.operateForm = row;\n        },\n        delUser (row){\n            this.$confirm(\"此操作將永久刪除該資料，是否繼續？\", \"提示\", {\n                confirmButtonText: \"確認\",\n                cancelButtonText: \"取消\",\n                type: \"warning\"\n            }).then(() => {\n                const id = row.id;\n                return this.$http.post(\"user/del\", { id: id });\n            }).then(() => {\n                this.getList();\n                this.$message.success('用戶已刪除');\n            }).catch(err => {\n                console.log(\"刪除操作取消\", err);\n                \n            })\n        },\n        getList(name = ''){\n            console.log('Search keyword:', name);\n            this.config.loading = true;\n            name ? (this.config.page = 1) : '';\n            getUser({\n                page: this.config.page,\n                name\n            }).then(({data: res}) => {\n                console.log(res, 'res');\n                this.tableData = res.list.map(item => {\n                    item.sex = item.sex === 0 ? \"女\": \"男\"\n                    return item \n                })\n                this.config.total = res.count;\n                this.config.loading = false;\n            });\n        }\n    },\n    created() {\n        this.getList();\n    }\n}\n\n</script>\n\n<style lang=\"less\" scoped>\n    .manage-header {\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n    }\n</style>"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}